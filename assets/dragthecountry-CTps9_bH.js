import{H as B}from"./header-CHALseqc.js";document.addEventListener("DOMContentLoaded",()=>{const C=document.getElementById("header");if(C){const d=new B;C.replaceWith(d.render())}let m,u=0;const L=document.getElementById("timer");function _(){m=setInterval(()=>{u++;const d=String(Math.floor(u/60)).padStart(2,"0"),g=String(u%60).padStart(2,"0");L.textContent=`${d}:${g}`},1e3)}function A(){clearInterval(m),u=0,L.textContent="00:00"}_(),fetch("/democracy-game/assets/countries_politicalsystem/countries_simple.json").then(d=>d.json()).then(d=>{const g=d.filter(e=>e.regime&&e.regime!=="N/A"&&e.regime!=="Hybrid"),a=document.getElementById("countries");a.innerHTML="";const p=["Democracy","Authoritarian","Monarchy","Totalitarian"],i={};p.forEach(e=>i[e]=0);let l=10;const h=document.getElementById("attempts-counter");h.textContent=`Attempts: ${l}`;const y=new Set;function E(){p.forEach(e=>{const t=document.getElementById(`guessed-${e}`);t&&(t.textContent=i[e])})}E(),g.forEach(e=>{const t=document.createElement("div");t.className="country-card";const r=document.createElement("img");r.className="country-shape__game",r.draggable=!0,r.alt=e.name,r.dataset.country=e.name,r.src=`/democracy-game/assets/images/generated_svgs/${e.iso_a2?e.iso_a2.toLowerCase()+"-shape.svg":"placeholder.svg"}`,r.onerror=function(){this.src="/democracy-game/assets/images/placeholder.svg"};const c=document.createElement("div");c.className="country-label",c.textContent=e.name,t.appendChild(r),t.appendChild(c),a.appendChild(t)});let f={};const q=document.querySelectorAll(".government-block");let s=null,o=!0;const x=new Set;a.querySelectorAll(".country-shape__game").forEach(e=>{e.addEventListener("dragstart",t=>{if(!o){t.preventDefault();return}s=e.parentElement})}),q.forEach(e=>{e.addEventListener("dragover",t=>{o&&(t.preventDefault(),e.classList.add("drag-over"))}),e.addEventListener("dragleave",()=>{e.classList.remove("drag-over")}),e.addEventListener("drop",t=>{if(o&&(t.preventDefault(),e.classList.remove("drag-over"),s)){const r=e.querySelector(".government-content");r?r.appendChild(s):e.appendChild(s);const c=s.querySelector(".country-shape__game").dataset.country;f[c]=e.dataset.gov,s=null}})}),a.addEventListener("dragover",e=>{o&&(e.preventDefault(),a.classList.add("drag-over"))}),a.addEventListener("dragleave",()=>{a.classList.remove("drag-over")}),a.addEventListener("drop",e=>{if(o&&(e.preventDefault(),a.classList.remove("drag-over"),s)){a.appendChild(s);const t=s.querySelector(".country-shape__game").dataset.country;delete f[t],s=null}});const v=document.getElementById("check-btn");v.addEventListener("click",()=>{if(!o)return;const e={};g.forEach(n=>e[n.name]=n.regime);let t=!0;const r=new Set;let c=!1;p.forEach(n=>i[n]=0),Object.keys(e).forEach(n=>{const S=document.querySelector(`[data-country='${n}']`).parentElement;if(f[n]!==e[n])t=!1,S.querySelector(".country-shape__game").style.border="2px solid red",r.add(n),c=!0;else{S.querySelector(".country-shape__game").style.border="2px solid green";const I=e[n];i[I]!==void 0&&i[I]++}}),c&&l>0&&l--,y.clear(),r.forEach(n=>y.add(n)),h.textContent=`Attempts: ${l}`,E(),t?(alert("Congratulations! All correct!"),clearInterval(m),o=!1,v.disabled=!0):l===0&&(alert("No attempts left! Please restart the game to play again."),clearInterval(m),o=!1,v.disabled=!0)}),document.getElementById("restart-btn").addEventListener("click",()=>{document.querySelectorAll(".country-card").forEach(e=>{a.appendChild(e),e.querySelector(".country-shape__game").style.border=""}),f={},p.forEach(e=>i[e]=0),l=10,h.textContent=`Attempts: ${l}`,E(),y.clear(),x.clear(),A(),_(),o=!0,v.disabled=!1})})});
