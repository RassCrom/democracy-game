import"./main-B0n_6eZY.js";import{m as S}from"./maplibre-gl-DtRcNtl7.js";const b=document.querySelector(".system-name"),C=document.querySelector(".top-info-bar .counter"),E=document.querySelector(".top-info-bar .timer"),m=document.getElementById("startButton"),p=document.getElementById("endButton");let k;var e=new S.Map({container:"map",style:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",center:[80,30],zoom:1,maxZoom:5,attributionControl:!1,renderWorldCopies:!1});let d=[],i=null,f=0,u=120,g=new Set,y=!1,n=null;m.disabled=!0;p.disabled=!0;fetch("../../public/assets/data/WorldBaseMap/Countries_Info.geojson").then(s=>s.json()).then(s=>{const o={};s.features.forEach(l=>{if(l.properties){for(const r in l.properties)if(r.startsWith("Political_")){const t=l.properties[r].trim();t!==null&&t!=="N/A"&&(o[r]||(o[r]={}),o[r][t]||(o[r][t]=0),o[r][t]++)}}});for(const l in o)for(const r in o[l])o[l][r]>0&&d.push({propertyKey:l,systemValue:r,count:o[l][r]});d.length>0&&(m.disabled=!1),e.on("load",()=>{const l=e.getStyle();l&&l.layers&&l.layers.filter(a=>a.type==="symbol").map(a=>a.id).forEach(a=>{e.getLayer(a)&&e.removeLayer(a)}),e.setPaintProperty("water","fill-color","#342F33"),e.addSource("countries",{type:"geojson",data:s,promoteId:"ADMIN"}),e.addLayer({id:"countries-layer",type:"fill",source:"countries",paint:{"fill-color":["case",["boolean",["feature-state","incorrect_click"],!1],"#FF3860",["boolean",["feature-state","clicked"],!1],"#47E18D","#FFEEE2"],"fill-opacity":["case",["boolean",["feature-state","incorrect_click"],!1],.9,["boolean",["feature-state","clicked"],!1],.8,["boolean",["feature-state","hover"],!1],1,.9],"fill-outline-color":"#342F33"}}),e.addLayer({id:"countries-lines",type:"line",source:"countries",layout:{},paint:{"line-color":"#342F33","line-width":["case",["boolean",["feature-state","clicked"],!1],1,["boolean",["feature-state","hover"],!1],1.5,.5]}}),s.features.forEach(t=>{t.properties&&t.properties.ADMIN&&e.setFeatureState({source:"countries",id:t.properties.ADMIN},{hover:!1,clicked:!1,incorrect_click:!1})});const r=new S.Popup({className:"custom-country-popup",closeButton:!1,closeOnClick:!1});e.on("mousemove","countries-layer",t=>{if(t.features.length>0){const a=t.features[0].id;e.getCanvas().style.cursor="pointer",n!==null&&n!==a&&e.setFeatureState({source:"countries",id:n},{hover:!1}),e.setFeatureState({source:"countries",id:a},{hover:!0}),n=a;const c=t.features[0].properties.ADMIN;r.setLngLat(t.lngLat).setHTML(c).addTo(e)}else e.getCanvas().style.cursor="",n!==null&&(e.setFeatureState({source:"countries",id:n},{hover:!1}),n=null),r.remove()}),e.on("mouseleave","countries-layer",()=>{e.getCanvas().style.cursor="",n!==null&&(e.setFeatureState({source:"countries",id:n},{hover:!1}),n=null),r.remove()}),e.on("click","countries-layer",t=>{if(y&&t.features.length>0){const a=t.features[0],c=a.properties.ADMIN;if(g.has(c))return;if(a.properties[i.propertyKey]===i.systemValue)f++,g.add(c),e.setFeatureState({source:"countries",id:c},{clicked:!0,hover:!1}),n===c&&(n=null),F(),f===i.count&&v(!0);else{const I=c;e.setFeatureState({source:"countries",id:I},{incorrect_click:!0})}}})})}).catch(s=>console.error("failed to load geojson",s));function h(){const s=Math.floor(u/60),o=u%60;E.textContent=`${s.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}function F(){C.textContent=`${f.toString().padStart(2,"0")}/${i.count.toString().padStart(2,"0")}`}function $(){if(d.length===0){alert("No game challenges available to start the game.");return}y=!0,m.disabled=!0,p.disabled=!1,e.getSource("countries")&&e.removeFeatureState({source:"countries"}),g.clear(),n=null;const s=Math.floor(Math.random()*d.length);i=d[s],f=0,b.textContent=`${i.systemValue.toUpperCase()}`,F(),u=120,h(),k=setInterval(()=>{u--,h(),u<=0&&v(!1)},1e3)}function v(s=!1){clearInterval(k),y=!1,m.disabled=!1,p.disabled=!0;let o="";s?o=`Congratulations! You found all ${i.count} ${i.systemValue} countries!`:u<=0?o=`Time's up! You found ${f} out of ${i.count} ${i.systemValue} countries.`:o=`Game over. You found ${f} out of ${i.count} ${i.systemValue} countries.`,setTimeout(()=>{alert(o),b.textContent="SYSTEM TYPE",C.textContent="00/00",E.textContent="00:00"},100)}m.addEventListener("click",$);p.addEventListener("click",()=>{y&&v(!1)});window.addEventListener("resize",function(){e&&e.resize()});h();
