import"./main-DjI55Zv1.js";var e=new maplibregl.Map({container:"map",style:"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",center:[80,30],zoom:1,maxZoom:5,attributionControl:!1,renderWorldCopies:!1});document.getElementById("map");const b=document.querySelector(".system-name"),k=document.querySelector(".top-info-bar .counter"),C=document.querySelector(".top-info-bar .timer"),m=document.getElementById("startButton"),y=document.getElementById("endButton");let d=[],c=null,f=0,u=120,p=new Set,g=!1,r=null;m.disabled=!0;y.disabled=!0;fetch("../../public/assets/data/WorldBaseMap/Countries_Info.geojson").then(a=>a.json()).then(a=>{const t={};a.features.forEach(l=>{if(l.properties){for(const s in l.properties)if(s.startsWith("Political_")){const o=l.properties[s].trim();o!==null&&o!=="N/A"&&(t[s]||(t[s]={}),t[s][o]||(t[s][o]=0),t[s][o]++)}}});for(const l in t)for(const s in t[l])t[l][s]>0&&d.push({propertyKey:l,systemValue:s,count:t[l][s]});d.length>0&&(m.disabled=!1),e.on("load",()=>{const l=e.getStyle();l&&l.layers&&l.layers.filter(n=>n.type==="symbol").map(n=>n.id).forEach(n=>{e.getLayer(n)&&e.removeLayer(n)}),e.setPaintProperty("water","fill-color","#342F33"),e.addSource("countries",{type:"geojson",data:a,promoteId:"ADMIN"}),e.addLayer({id:"countries-layer",type:"fill",source:"countries",paint:{"fill-color":["case",["boolean",["feature-state","incorrect_click"],!1],"#FF3860",["boolean",["feature-state","clicked"],!1],"#47E18D","#FFEEE2"],"fill-opacity":["case",["boolean",["feature-state","incorrect_click"],!1],.9,["boolean",["feature-state","clicked"],!1],.8,["boolean",["feature-state","hover"],!1],1,.9],"fill-outline-color":"#342F33"}}),e.addLayer({id:"countries-lines",type:"line",source:"countries",layout:{},paint:{"line-color":"#342F33","line-width":["case",["boolean",["feature-state","clicked"],!1],1,["boolean",["feature-state","hover"],!1],1.5,.5]}}),a.features.forEach(o=>{o.properties&&o.properties.ADMIN&&e.setFeatureState({source:"countries",id:o.properties.ADMIN},{hover:!1,clicked:!1,incorrect_click:!1})});const s=new maplibregl.Popup({className:"custom-country-popup",closeButton:!1,closeOnClick:!1});e.on("mousemove","countries-layer",o=>{if(o.features.length>0){const n=o.features[0].id;e.getCanvas().style.cursor="pointer",r!==null&&r!==n&&e.setFeatureState({source:"countries",id:r},{hover:!1}),e.setFeatureState({source:"countries",id:n},{hover:!0}),r=n;const i=o.features[0].properties.ADMIN;s.setLngLat(o.lngLat).setHTML(i).addTo(e)}else e.getCanvas().style.cursor="",r!==null&&(e.setFeatureState({source:"countries",id:r},{hover:!1}),r=null),s.remove()}),e.on("mouseleave","countries-layer",()=>{e.getCanvas().style.cursor="",r!==null&&(e.setFeatureState({source:"countries",id:r},{hover:!1}),r=null),s.remove()}),e.on("click","countries-layer",o=>{if(g&&o.features.length>0){const n=o.features[0],i=n.properties.ADMIN;if(p.has(i))return;if(n.properties[c.propertyKey]===c.systemValue)f++,p.add(i),e.setFeatureState({source:"countries",id:i},{clicked:!0,hover:!1}),r===i&&(r=null),F(),f===c.count&&S(!0);else{const h=i;e.setFeatureState({source:"countries",id:h},{incorrect_click:!0}),setTimeout(()=>{e.getSource("countries")&&e.getFeatureState({source:"countries",id:h})&&e.setFeatureState({source:"countries",id:h},{incorrect_click:!1})},300)}}})})}).catch(a=>console.error("failed to load geojson",a));function v(){const a=Math.floor(u/60),t=u%60;C.textContent=`${a.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`}function F(){k.textContent=`${f.toString().padStart(2,"0")}/${c.count.toString().padStart(2,"0")}`}function E(){if(d.length===0){alert("No game challenges available to start the game.");return}g=!0,m.disabled=!0,y.disabled=!1,e.getSource("countries")&&(p.forEach(t=>{e.setFeatureState({source:"countries",id:t},{clicked:!1,hover:!1,incorrect_click:!1})}),r!==null&&(e.getSource("countries")&&e.getFeatureState({source:"countries",id:r})&&e.setFeatureState({source:"countries",id:r},{hover:!1,clicked:!1,incorrect_click:!1}),r=null)),p.clear();const a=Math.floor(Math.random()*d.length);c=d[a],f=0,b.textContent=`${c.systemValue.toUpperCase()}`,F(),u=120,v(),timerInterval=setInterval(()=>{u--,v(),u<=0&&S(!1)},1e3)}function S(a=!1){clearInterval(timerInterval),g=!1,m.disabled=!1,y.disabled=!0;let t="";a?t=`Congratulations! You found all ${c.count} ${c.systemValue} countries!`:u<=0?t=`Time's up! You found ${f} out of ${c.count} ${c.systemValue} countries.`:t=`Game over. You found ${f} out of ${c.count} ${c.systemValue} countries.`,setTimeout(()=>{alert(t),b.textContent="SYSTEM TYPE",k.textContent="00/00",C.textContent="00:00"},100)}m.addEventListener("click",E);y.addEventListener("click",()=>{g&&S(!1)});window.addEventListener("resize",function(){e&&e.resize()});v();
